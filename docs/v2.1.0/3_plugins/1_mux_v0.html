<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>The Mux v0 Plugin - WizToolKit</title>
    <link rel="stylesheet"
        href="/wiztoolkit/assets/css/fonts.css" />
    <link rel="stylesheet"
        href="/wiztoolkit/assets/css/layout.css" />
    <link rel="stylesheet"
        href="/wiztoolkit/assets/css/content.css" />

    <link rel="shortcut icon" type="image/png"
        href="/wiztoolkit/assets/icons/tetra-solid-32x32.png" />

    <link type="application/atom+xml" rel="alternate" href="https://stealthsoftwareinc.github.io/wiztoolkit/feed.xml" title="WizToolKit" />
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>The Mux v0 Plugin | WizToolKit</title>
<meta name="generator" content="Jekyll v4.2.2" />
<meta property="og:title" content="The Mux v0 Plugin" />
<meta property="og:locale" content="en_US" />
<link rel="canonical" href="https://stealthsoftwareinc.github.io/wiztoolkit/docs/v2.1.0/3_plugins/1_mux_v0.html" />
<meta property="og:url" content="https://stealthsoftwareinc.github.io/wiztoolkit/docs/v2.1.0/3_plugins/1_mux_v0.html" />
<meta property="og:site_name" content="WizToolKit" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="The Mux v0 Plugin" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","headline":"The Mux v0 Plugin","url":"https://stealthsoftwareinc.github.io/wiztoolkit/docs/v2.1.0/3_plugins/1_mux_v0.html"}</script>
<!-- End Jekyll SEO tag -->


    <script>0</script>
  </head>
  <body>
    <header>
      <nav id="topNav">
        <a href="#main" id="jumpMain">Jump to Main</a>
        <a href="https://www.stealthsoftwareinc.com" id="logoImg">
          <img
            src="/wiztoolkit/assets/icons/tetra-solid-100x100.png"
            alt="Stealth Software Technologies Home Page" /></a>
        <a href="/wiztoolkit/" id="titleLink">WizToolKit</a>
        <span id="spacer">&nbsp;</span>
        
          
            <a href="/wiztoolkit/"
              
              >about</a>
          
        
          
            <a href="/wiztoolkit/docs/v2.1.0/"
              
              >docs</a>
          
        
          
            <a href="https://github.com/stealthsoftwareinc/wiztoolkit"
              
              >source</a>
          
        
      </nav>
    </header>
    <nav id=docsNav>
  <div>
    <h2 class="eyebrow">Docs Nav</h2>
    <p>
      <label for="version_select">Change Version:</label> <select name="version_select" onchange="location = this.value;"><option selected value="/wiztoolkit/docs/v2.1.0/">v2.1.0</option><option  value="/wiztoolkit/docs/v1.0.1/">v1.0.1</option></select>
    </p>

    
    <ul><li><a href="/wiztoolkit/docs/v2.1.0/">WizToolKit Manual</a><ul><li><a href="/wiztoolkit/docs/v2.1.0/0_intro.html">Introduction to the WizToolKit Manual</a></li><li><a href="/wiztoolkit/docs/v2.1.0/1_parsing.html">Parsing the IR</a></li><li><a href="/wiztoolkit/docs/v2.1.0/2_nails.html">NAILS Circuit-IR Interpreter</a></li><li>3_plugins<ul><li><a href="/wiztoolkit/docs/v2.1.0/3_plugins/0_intro.html">Plugins Intro</a></li><li><a href="/wiztoolkit/docs/v2.1.0/3_plugins/1_extended_arithmetic.html">The Extended Arithmetic Plugin</a></li><li><a href="/wiztoolkit/docs/v2.1.0/3_plugins/1_iter_v0.html">Iteration v0 Plugin</a></li><li class="curr_page"><a href="/wiztoolkit/docs/v2.1.0/3_plugins/1_mux_v0.html">The Mux v0 Plugin</a>
      <ul class="sectlevel1">
<li><a href="#operations">Operations</a></li>
<li><a href="#implementing-the-mux-v0-plugin">Implementing the Mux v0 Plugin</a></li>
<li><a href="#implementing-your-own-multiplexer">Implementing your own Multiplexer</a></li>
<li><a href="#the-fallback-multiplexer">The Fallback Multiplexer</a></li>
<li><a href="#setting-up-the-multiplexer-plugin">Setting up the Multiplexer plugin</a></li>
</ul>
    </li><li><a href="/wiztoolkit/docs/v2.1.0/3_plugins/1_ram_arith.html">RAM Arithmetic Plugin</a></li><li><a href="/wiztoolkit/docs/v2.1.0/3_plugins/1_ram_bool_v0.html">RAM Boolean v0 Plugin</a></li><li><a href="/wiztoolkit/docs/v2.1.0/3_plugins/1_wizkit_vectors.html">The Wizkit Vectors Plugin</a></li></ul></li><li>4_tools<ul><li><a href="/wiztoolkit/docs/v2.1.0/4_tools/firealarm.html"><code>wtk-firealarm</code></a></li><li><a href="/wiztoolkit/docs/v2.1.0/4_tools/press.html"><code>wtk-press</code></a></li></ul></li><li><a href="/wiztoolkit/docs/v2.1.0/5_testcases.html">Generating Test Cases with WizToolKit</a></li><li>6_sample_backends<ul><li><a href="/wiztoolkit/docs/v2.1.0/6_sample_backends/0_intro.html">Sample Backend Code</a></li><li><a href="/wiztoolkit/docs/v2.1.0/6_sample_backends/1_simple.html">Simple Arithmetic Demo Backend</a></li><li><a href="/wiztoolkit/docs/v2.1.0/6_sample_backends/2_multitype.html">Arithmetic and Boolean Demo Backend</a></li><li><a href="/wiztoolkit/docs/v2.1.0/6_sample_backends/3_simple_plugins.html">Simple Arithmetic Demo Backend with Plugins</a></li></ul></li><li><a href="/wiztoolkit/docs/v2.1.0/7_install.html">Installing WizToolKit</a></li></ul></li></ul>
  </div>
</nav>

<main id="main" tabindex="-1">
  <h1>The Mux v0 Plugin</h1>
  <div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>The <code>mux_v0</code> plugin provides a multiplexer functionality.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="operations">Operations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Two multiplexer behaviors are provided, each having a different error behavior when the selector bit exceeds the number of input cases.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>permissive</code></dt>
<dd>
<p>Produces zeroes when the selector bit exceeds the number of inputs.</p>
</dd>
<dt class="hdlist1"><code>strict</code></dt>
<dd>
<p>Fails an <code>@assert_zero</code> when the selector bit exceeds the number of inputs.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>These operations do not use any additional plugin operations.
The size of each input is recognized by the size of the output, and the number of inputs is recognized by the repetition of the output sizes over the inputs.
Here is an example.</p>
</div>
<div class="listingblock">
<div class="content">
<pre>//                        |-size--|      |-selector
@function(mux_demo, @out: 0:2, 0:4, @in: 0:1,
                          0:2, 0:4, // input case 0
                          0:2, 0:4, // input case 1
                          0:2, 0:4, // input case 2
                          0:2, 0:4, // input case 3
                          0:2, 0:4) // input case 4
  @plugin(mux_v0, strict);</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, there are two output ranges&#8201;&#8212;&#8201;<code>0:2</code> and <code>0:4</code>, and that shape is repeated 5 times as input cases.</p>
</div>
<div class="paragraph">
<p>Formally, using type <code>t</code>, and sizes <code>s1</code> through <code>sn</code>, the following parameters are allowed.
When <code>t</code> is of boolean type, the selector may have width <code>w</code>.</p>
</div>
<div class="ulist">
<div class="title">Function Signature</div>
<ul>
<li>
<p>Output <code>t:s1</code>: first output range</p>
</li>
<li>
<p>&#8230;&#8203;</p>
</li>
<li>
<p>Output <code>t:sn</code>: last output range</p>
</li>
<li>
<p>Input <code>t:1</code> or <code>t:w</code>: selector wire or selector range (boolean only)</p>
</li>
<li>
<p>For each input case:</p>
<div class="ulist">
<ul>
<li>
<p>Input <code>t:s1</code>: input range corresponding to the first output range</p>
</li>
<li>
<p>&#8230;&#8203;</p>
</li>
<li>
<p>Input <code>t:sn</code>: input range corresponding to the last output range</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
<div class="ulist">
<div class="title">Plugin Binding</div>
<ul>
<li>
<p>Plugin Name: <code>mux_v0</code></p>
</li>
<li>
<p>Operation: <code>permissive</code> or <code>strict</code></p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Currently, WizToolKit supports only arithmetic multiplexers.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="implementing-the-mux-v0-plugin">Implementing the Mux v0 Plugin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can implement the <code>mux_v0</code> plugin by subclassing a few classes, or you can rely on WziToolKit&#8217;s fallback implementation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="implementing-your-own-multiplexer">Implementing your own Multiplexer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The core of your multiplexer will implement the <code>wtk::plugins::MuxOperation&lt;Number_T, Wire_T&gt;::evaluateMux(&#8230;&#8203;)</code> method (from <a href="/src/main/cpp/wtk/plugins/Multiplexer.h"><code>#include &lt;wtk/plugins/Multiplexer.h&gt;</code></a>).
Remember you will need to implement both the <code>strict</code> and <code>permissive</code> multiplexer operations: either with one subclass handling both or with two subclasses.</p>
</div>
<div class="paragraph">
<p>The <code>outputs</code> and <code>inputs</code> vectors are groups of wire ranges.
Each <code>Wire_T*</code> of <code>outputs</code> and <code>Wire_T const*</code> of <code>inputs</code> is a pointer to the first element of a range, length determined by <code>sizes</code>.
<code>inputs</code> is nested vector, because each multiplexer case is a group of ranges congruent to the <code>outputs</code>.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="c++"><span></span><span class="tok-k">virtual</span><span class="tok-w"> </span><span class="tok-kt">void</span><span class="tok-w"> </span><span class="tok-nf">evaluateMux</span><span class="tok-p">(</span><span class="tok-n">std</span><span class="tok-o">::</span><span class="tok-n">vector</span><span class="tok-o">&lt;</span><span class="tok-kt">size_t</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-k">const</span><span class="tok-o">&amp;</span><span class="tok-w"> </span><span class="tok-n">sizes</span><span class="tok-p">,</span>
<span class="tok-w">    </span><span class="tok-n">std</span><span class="tok-o">::</span><span class="tok-n">vector</span><span class="tok-o">&lt;</span><span class="tok-n">Wire_T</span><span class="tok-o">*&gt;&amp;</span><span class="tok-w"> </span><span class="tok-n">outputs</span><span class="tok-p">,</span>
<span class="tok-w">    </span><span class="tok-n">Wire_T</span><span class="tok-w"> </span><span class="tok-k">const</span><span class="tok-o">*</span><span class="tok-w"> </span><span class="tok-k">const</span><span class="tok-w"> </span><span class="tok-n">selector</span><span class="tok-p">,</span>
<span class="tok-w">    </span><span class="tok-n">std</span><span class="tok-o">::</span><span class="tok-n">vector</span><span class="tok-o">&lt;</span><span class="tok-n">std</span><span class="tok-o">::</span><span class="tok-n">vector</span><span class="tok-o">&lt;</span><span class="tok-n">Wire_T</span><span class="tok-w"> </span><span class="tok-k">const</span><span class="tok-o">*&gt;&gt;&amp;</span><span class="tok-w"> </span><span class="tok-n">inputs</span><span class="tok-p">)</span><span class="tok-w"> </span><span class="tok-k">override</span>
<span class="tok-p">{</span>
<span class="tok-w">  </span><span class="tok-cm">/* Your code here */</span>
<span class="tok-p">}</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You must also subclass <code>wtk::plugins::MultiplexerPlugin&lt;Number_T, Wire_T&gt;</code>, as essentially a factory for mux operations.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="the-fallback-multiplexer">The Fallback Multiplexer</h2>
<div class="sectionbody">
<div class="paragraph">
<p>WizToolKit provides the <code>wtk::plugins::FallbackMultiplexerPlugin&lt;Number_T, Wire_T&gt;</code> using <a href="https://en.wikipedia.org/wiki/Fermat&#8217;s_little_theorem">Fermat&#8217;s Little Theorem</a> to check equality of the selector with each case number.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="setting-up-the-multiplexer-plugin">Setting up the Multiplexer plugin</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To setup the multiplexer plugin, all you need do is pass a plugin object to the <code>PluginsManager&lt;Number_T, Wire_Ts&#8230;&#8203;&gt;</code> for every <code>Wire_T</code> which you intend to support the plugin (so typically all of them).</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="c++"><span></span><span class="tok-n">wtk</span><span class="tok-o">::</span><span class="tok-n">plugins</span><span class="tok-o">::</span><span class="tok-n">PluginsManager</span><span class="tok-o">&lt;</span><span class="tok-n">Number</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">WireA</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">Wire_B</span><span class="tok-o">&gt;</span><span class="tok-w"> </span><span class="tok-n">plugins_manager</span><span class="tok-p">;</span>

<span class="tok-n">std</span><span class="tok-o">::</span><span class="tok-n">unique_ptr</span><span class="tok-o">&lt;</span><span class="tok-n">MyMuxPlugin</span><span class="tok-o">&lt;</span><span class="tok-n">Number</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">WireA</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"> </span><span class="tok-n">mux_a</span><span class="tok-p">(</span>
<span class="tok-w">    </span><span class="tok-k">new</span><span class="tok-w"> </span><span class="tok-n">MyMuxPlugin</span><span class="tok-o">&lt;</span><span class="tok-n">Number</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">WireA</span><span class="tok-o">&gt;</span><span class="tok-p">());</span>
<span class="tok-n">plugins_manager</span><span class="tok-p">.</span><span class="tok-n">addPlugin</span><span class="tok-p">(</span><span class="tok-s">&quot;mux_v0&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">std</span><span class="tok-o">::</span><span class="tok-n">move</span><span class="tok-p">(</span><span class="tok-n">mux_a</span><span class="tok-p">));</span>

<span class="tok-n">std</span><span class="tok-o">::</span><span class="tok-n">unique_ptr</span><span class="tok-o">&lt;</span><span class="tok-n">MyMuxPlugin</span><span class="tok-o">&lt;</span><span class="tok-n">Number</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">WireB</span><span class="tok-o">&gt;&gt;</span><span class="tok-w"> </span><span class="tok-n">mux_b</span><span class="tok-p">(</span>
<span class="tok-w">    </span><span class="tok-k">new</span><span class="tok-w"> </span><span class="tok-n">MyMuxPlugin</span><span class="tok-o">&lt;</span><span class="tok-n">Number</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">WireB</span><span class="tok-o">&gt;</span><span class="tok-p">());</span>
<span class="tok-n">plugins_manager</span><span class="tok-p">.</span><span class="tok-n">addPlugin</span><span class="tok-p">(</span><span class="tok-s">&quot;mux_v0&quot;</span><span class="tok-p">,</span><span class="tok-w"> </span><span class="tok-n">std</span><span class="tok-o">::</span><span class="tok-n">move</span><span class="tok-p">(</span><span class="tok-n">mux_b</span><span class="tok-p">));</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For more details, see the <a href="../0_intro.html#implementing_plugins">general plugins</a> section of this manual.</p>
</div>
</div>
</div>
</main>

    <footer>
      
        <p id="distributionStatement">
          <strong>Distribution Statement A:</strong> Approved for Public Release, Distribution Unlimited.
        </p>
      
      <p>
        Copyright &copy; 2023, Stealth Software Technologies, Inc.
        All Rights Reserved.
      </p>
      
        <p id="acknowledgement">
          This research was developed with funding from the Defense Advanced Research Projects Agency (DARPA) under Contract No. HR001120C0087. The views, opinions, and/or findings expressed are those of the author(s) and should not be interpreted as representing the official views or policies of the Department of Defense or the U.S. Government.
        </p>
      

      <a href="https://www.stealthsoftwareinc.com" id="bottomLogoImg">
        <img
          src="/wiztoolkit/assets/icons/tetra-solid-400x100.png"
          alt="Stealth Software Technologies Home Page" /></a>

      
    </footer>
  </body>
</html>

